{% load staticfiles %}
{% load widget_tweaks %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <title>Document</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="description" content="Page description">
    <meta name="keywords" content="page, keywords">
    <meta name="theme-color" content="#000000">
    <meta name="copyright" content="Author">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#000000">
    <meta name="apple-mobile-web-app-title" content="Application Name">
    <meta name="msapplication-TileImage" content="img/favicons/144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="format-detection" content="telephone=no">
    <style type="text/css">
        body {
            background: transparent url({% static 'img/diagonal.png' %}) repeat scroll 50%
        }
    </style>
    <link rel="preload" href="{% static 'css/libs.min.css' %}" as="style"
          onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="{% static 'css/libs.min.css' %}">
    </noscript>
    <link rel="preload" href="{% static 'css/style.min.css' %}" as="style"
          onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="{% static 'css/style.min.css' %}">
    </noscript>
    <script>!function (t) {
        "use strict";
        t.loadCSS || (t.loadCSS = function () {
        });
        var e = loadCSS.relpreload = {};
        if (e.support = function () {
                var e;
                try {
                    e = t.document.createElement("link").relList.supports("preload")
                } catch (t) {
                    e = !1
                }
                return function () {
                    return e
                }
            }(), e.bindMediaToggle = function (t) {
                var e = t.media || "all";

                function a() {
                    t.media = e
                }

                t.addEventListener ? t.addEventListener("load", a) : t.attachEvent && t.attachEvent("onload", a), setTimeout(function () {
                    t.rel = "stylesheet", t.media = "only x"
                }), setTimeout(a, 3e3)
            }, e.poly = function () {
                if (!e.support()) for (var a = t.document.getElementsByTagName("link"), n = 0; n < a.length; n++) {
                    var o = a[n];
                    "preload" !== o.rel || "style" !== o.getAttribute("as") || o.getAttribute("data-loadcss") || (o.setAttribute("data-loadcss", !0), e.bindMediaToggle(o))
                }
            }, !e.support()) {
            e.poly();
            var a = t.setInterval(e.poly, 500);
            t.addEventListener ? t.addEventListener("load", function () {
                e.poly(), t.clearInterval(a)
            }) : t.attachEvent && t.attachEvent("onload", function () {
                e.poly(), t.clearInterval(a)
            })
        }
        "undefined" != typeof exports ? exports.loadCSS = loadCSS : t.loadCSS = loadCSS
    }("undefined" != typeof global ? global : this);</script>
    <link rel="shortcut icon" href="img/favicons/64x64.png" type="image/png">
    <link rel="icon" href="img/favicons/152x152.png" type="image/png" sizes="152x152">
    <link rel="icon" href="img/favicons/256x256.png" type="image/png" sizes="256x256">
    <link rel="icon" href="img/favicons/512x512.png" type="image/png" sizes="512x512">
    <link rel="apple-touch-icon" href="img/favicons/152x152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="img/favicons/256x256.png" sizes="256x256">
    <link rel="apple-touch-icon" href="img/favicons/512x512.png" sizes="512x512">
    <link rel="manifest" href="manifest.json">
</head>
<body class="uk-animation-fade">
<header uk-sticky="top: 500; animation: uk-animation-slide-top; bottom: #sticky-on-scroll-up">
    <div class="uk-container">
        <nav class="uk-navbar" uk-navbar="">
            <div class="uk-navbar-left">
                <ul class="uk-navbar-nav">
                    <li><a href="{% url 'main' %}">Logo</a></li>
                </ul>
                <ul class="uk-navbar-nav">
                    <li class="uk-active"><a href="{% url 'main' %}">Главная</a></li>
                    <li><a href="#">Маркетинг</a></li>
                    <li><a href="#">Faq</a></li>
                    <li><a href="#">Соглашение</a></li>
                </ul>
                <ul class="uk-navbar-nav social">
                    <li><a href="#">VK</a></li>
                    <li><a href="#">FB</a></li>
                    <li><a href="#">OD</a></li>
                </ul>
            </div>
            <div class="uk-navbar-right">
                <ul class="uk-navbar-nav reg uk-text-center">
                    {% if request.user.is_authenticated %}
                        <li><a href="{% url 'profile' %}">{{ request.user }}</a></li>
                        <li><a href="{% url 'logout' %}">Выход</a></li>
                    {% else %}
                        <li><a href="#" uk-toggle="target: #enter">Вход</a></li>
                        <li><a href="#" uk-toggle="target: #registration"> Регистрация</a></li>
                    {% endif %}
                </ul>
            </div>
        </nav>
    </div>
</header>
{% block content %}
{% endblock %}
<footer>
    <div class="uk-container">
        <div class="uk-grid uk-child-width-1-3@m">
            <div>
                <div class="item">
                    <p>Copyright © 2018</p>
                </div>
            </div>
            <div>
                <div class="item">
                    <p>Copyright © 2018</p>
                </div>
            </div>
            <div>
                <div class="item">
                    <p>Copyright © 2018</p>
                </div>
            </div>
        </div>
    </div>
</footer>
<!-- This is the modal enter-->
<div id="enter" uk-modal="">
    <div class="uk-modal-dialog uk-modal-body">
        <button class="uk-modal-close-default" type="button" uk-close=""></button>
        <form action="{% url 'login' %}" method="POST" id="login-form">
            {% csrf_token %}
            <fieldset class="uk-fieldset">
                <legend class="uk-legend">Вход</legend>
                <div class="uk-margin">
                    {% render_field login_form.username class+='uk-input' %}
                </div>
                <div class="uk-margin">
                    {% render_field login_form.password class+='uk-input' %}
                </div>
                <button class="uk-button uk-button-primary" type="submit">Войти</button>
            </fieldset>
        </form>
    </div>
</div>
<!-- This is the modal registration-->
<div id="registration" uk-modal="">
    <div class="uk-modal-dialog uk-modal-body">
        <button class="uk-modal-close-default" type="button" uk-close=""></button>
        <form action="{% url 'create_user' %}" method="POST" id="user-form">
            {% csrf_token %}
            <fieldset class="uk-fieldset">
                <legend class="uk-legend">Регистрация</legend>
                <div class="uk-margin">
                    {% render_field signup_form.username class+='uk-input' placeholder='Логин' %}
                </div>
                <div class="uk-margin">
                    {% render_field signup_form.first_name class+='uk-input' placeholder='Имя' %}
                </div>
                <div class="uk-margin">
                    {% render_field signup_form.email class+='uk-input' placeholder='Почта' %}
                </div>
                <div class="uk-margin">
                    {% render_field signup_form.password1 class+='uk-input' placeholder='Пароль' %}
                </div>
                <div class="uk-margin">
                    {% render_field signup_form.password2 class+='uk-input' placeholder='Повторите пароль' %}
                </div>
                <button class="uk-button uk-button-primary" type="submit">Регистрация</button>
            </fieldset>
        </form>
    </div>
</div>
<script src="{% static 'js/libs.min.js' %}"></script>
<script src="{% static 'js/common.min.js' %}"></script>
<script type="text/javascript">
    function ajax_request(form) {
        $(form).on('submit', function (e) {
            e.preventDefault();
            $.ajax({
                url: $(this).attr('action'),
                data: $(this).serialize(),
                method: 'POST',
                datatype: 'JSON',
                success: function (response) {
                    if (response.success) {
                        setTimeout(function () {
                            window.location = window.location.href;
                        }, 200)
                    }
                    else {
                        UIkit.notification.closeAll();
                        UIkit.notification(response.message, 'danger');
                    }
                }
            })
        })
    }

    $(document).ready(function () {
        ajax_request($('#user-form'));
        ajax_request($('#login-form'));
    })
</script>
{% block custom_scripts %}
{% endblock %}
</body>
</html>